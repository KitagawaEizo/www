# YouTube でのライブ配信の始め方

YouTube でライブ配信をしたい場合，事前<sup>[1]</sup>に手続きが必要になります．手続きといっても簡単なものですが，その方法を以下に示します．

[1] : 配信を行いたい日の少なくとも 24 時間前までに手続きを済ませる必要があります．

## 1. YouTube アカウントの準備

YouTube でライブ配信を行うには，Google アカウントが必要です．ほとんどの方は既にお持ちだと思いますので手順は省略しますが，配信を行いたいアカウントを用意し，YouTube にログインしてください．

## 2. ライブ配信の有効化

<https://youtube.com/> にアクセスし，検索窓がある列の右端，「作成」ボタンをクリックすると，「ライブ配信を開始」という項目が出てくるので，それをクリックします．

![](./imgs/1.png)

すると，このような画面に遷移します．

![](./imgs/2.png)

画面中央にある「リクエスト」ボタンをクリックしましょう．

![](./imgs/3.png)

電話番号の確認を求めるダイヤログが出ます．「確認」ボタンをクリックしてください．  
すると，新しいタブで以下のようなページが開きます．ここに確認用の電話番号を入力し，「テキストメッセージで受け取る」か「音声通話で受け取る」かを選択して「次へ」ボタンをクリックします．

![](./imgs/4.png)

しばらくすると，入力した電話番号に確認コードが届きます．そのコードを以下の画面で入力し，「送信」ボタンをクリックします．

![](./imgs/5.png)

これでライブ配信の有効化が完了しました．通常，24 時間以内に有効化されます．有効化されると，ライブ配信が可能になります．  
このような画面になります．この画面はもう閉じて大丈夫です．

![](./imgs/6.png)

元のページはこのようになっているはずです．24 時間以上待ってから再度開きましょう．

![](./imgs/7.png)

余談ですが，電話番号が確認できたかどうかは <https://www.youtube.com/verify> で確認できます．

## 3. ライブ配信の開始

ライブ配信の有効化が完了すると，このような画面になります．

![](./imgs/8.png)

今すぐライブ配信を始めたい場合は，「始める」をクリックします．後で行う場合は「後で」をクリックします．  
今回は「後で」を選択します．すると，どのような方法で配信するかを選ぶ画面になります．

![](./imgs/9.png)

今回は「ストリーミング ソフトウェア」を選択します．

これで，ライブ配信の準備が整いました．あとは配信ソフトウェア（例: OBS Studio）を用いて配信を行うだけです．  
今回は OBS Studio を用いて配信を行います．

OBS Studio を起動し，「設定」ボタンをクリックします．

![](./imgs/10.png)

設定ウィンドウが開くので，左側のメニューから「配信」を選択します．

![](./imgs/11.png)

右側ペインの最上部にある「サービス」ドロップダウンメニューから「YouTube RTMPS」を選択します．

![](./imgs/12.png)

すると，YouTube 用の設定項目が表示されます．

![](./imgs/13.png)

「サーバー」ドロップダウンメニューが「Primary YouTube ingest server」となっていれば OK です．  
その下の「ストリームキーを使用する（高度）」をクリックし，ストリームキー入力欄を表示させます．

![](./imgs/14.png)

YouTube のライブ配信設定画面に戻り，ストリームキーを取得しましょう．

「ライブ配信をスケジュール設定」ボタンをクリックすると，「配信の作成」というウィンドウが表示されます．

![](./imgs/15.png)

ここで配信のタイトルや概要欄の説明，カテゴリ，サムネイルなどの設定を行います．  

一番下の「視聴者」の項目で，「子ども向けではない」か「子ども向け」のどちらかを選択する必要があります．ほとんどの場合は「いいえ、子ども向けではありません」となります．

![](./imgs/16.png)

設定が完了したら，「次へ」ボタンをクリックします．

次の画面では，配信のカスタマイズが出来ます．具体的には，チャット欄の設定や，チャットメッセージを送信できるユーザの範囲の設定などです．必要に合わせて調整してください．出来たら「次へ」ボタンをクリックします．

![](./imgs/17.png)

最後に，配信の公開範囲とスケジュール（配信開始時間）の設定を行います．まずは「非公開」か「限定公開」でテスト配信を行うことをオススメします．

![](./imgs/18.png)

スケジュールで設定できる時間は，プルダウンメニューから選択するか，直接入力することも可能です．デフォルトでは 15 分刻みで設定できます．設定が完了したら「完了」ボタンをクリックします．

すると，このような画面になります．

![](./imgs/19.png)

左下の枠に「ストリームキー」が黒丸潰しで表示されています．「コピー」ボタンをクリックしてストリームキーをコピーし，OBS Studio のストリームキー入力欄にペーストします．

<div align="center"><img src="./imgs/20.png"></div>

入力できたら，「適用」ボタンをクリックします．

---

続いては，OBS から YouTube へ送信する映像の設定です．

同じ設定ウィンドウの左側メニューから「映像」を選択します．

<div align="center"><img src="./imgs/21.png"></div>

「基本（キャンバス）解像度」と「出力（スケーリング）解像度」をそれぞれ `1920x1080` に設定します．  
「FPS 共通値」は `30` または `60` に設定します．設定できたら「適用」ボタンをクリックします．

左側メニューから「出力」を選択し，YouTube の推奨ビットレート<sup>[2]</sup>に合わせて，以下のように設定します．

<div align="center"><img src="./imgs/22.png"></div>

「映像ビットレート」は HD60P での配信の場合 12Mbps が推奨されているので，`12000` に設定します．「音声ビットレート」は `128` に．「映像エンコーダ」は PC によりますが，「ハードウェア」と付くものを使用しましょう．NVIDIA 製の GPU を搭載していれば NVENC が使えます．コーデック（H.264 / H.265 HEVC / AV1 などの映像圧縮方式）を選べる場合，H.264 を選択します．Intel 製 CPU に内蔵の GPU が使える PC では QSV が使えます．

エンコーダプリセットは P4 か P5 あたりが無難です．

参考画像：この PC の場合，Intel QSV / NVIDIA NVENC の両方が使えます．また，搭載している GPU が比較的新しい<sup>[3]</sup>ため，H.264 / HEVC / AV1 が選択可能になっています．

[2] : YouTube の推奨ビットレートについては，以下の公式ドキュメントを参照してください．  
<https://support.google.com/youtube/answer/2853702?hl=ja>

[3] : NVIDIA GeForce RTX4060 Laptop GPU 搭載のノート PC を使用しています．

<div align="center"><img src="./imgs/23.png"></div>

「録画」の枠の設定で，配信映像をローカルに保存することも可能です．必要に応じて設定してください．

「録画ファイルのパス」から保存する場所を，「録画品質」から保存する映像の品質を，「録画フォーマット」から保存する形式を，「映像エンコーダ」から使用するエンコーダを，それぞれ設定できます．

「録画フォーマット」は `Matroska Video (.mkv)` を選択することをオススメします．配信中に OBS がクラッシュした場合でも，録画ファイルが壊れにくいためです．後で必要に応じて `mp4` などに変換（最多重化）できます．

「音声トラック」のチェックボックスは，録画ファイルに保存したい音声トラックを選択します．それぞれのトラックにどの音声ソースが割り当てられているかは，左側メニュー「音声」で設定できます．

「音声」メニューでは，配信に使用する音声ソースの設定ができます．

<div align="center"><img src="./imgs/24.png"></div>

「一般」より「サンプルレート」を `44.1 kHz` に，「チャンネル」を `ステレオ` に設定します．

「グローバル音声デバイス」から使用する音声デバイスを選択します．配信内容に応じて，入力を設定してください．  
私の場合，以下のように設定しています．

<div align="center"><img src="./imgs/25.png"></div>

「デスクトップ音声」の「SPDIF Out (Studio 68c)」は，PC に接続しているオーディオインターフェース（PreSonus Studio 68c）の S/PDIF 出力で，普段デスクトップ音声の出力先として使用しているデバイスです．  
「デスクトップ音声 2」の「Main Out 1/2 (Studio 68c)」は，同じくオーディオインターフェースの出力デバイスで，ヘッドホンを使用する際の出力先として使用しているデバイスです．  
「マイク音声」の「Mic/Inst/Line In 1/2 (Studio 68c)」と「マイク音声 2」の「Mic/Line In 3/4 (Studio 68c)」はオーディオインターフェースの入力で，マイクや楽器，ワイヤレスの受信機などを接続しています．  
「マイク音声 3」と「マイク音声 4」はそれぞれ PCIe 接続の映像キャプチャカードからの音声入力です．

設定して閉じ， OBS のメインウィンドウに戻ります．

![](./imgs/26.png)

「音声ミキサー」欄に，先ほど設定した音声ソースが表示されているはずです．この画面では垂直レイアウトを使用しているので横並びですが，デフォルトでは縦並びになっています．（一番下の `⋮` から切り替え可能です．）  
ここで各音声ソースの音量調整ができます．  
左下の歯車アイコンをクリックすると，音声入力の詳細設定が行えます．

<div align="center"><img src="./imgs/27.png"></div>

開くと，「オーディオの詳細プロパティ」ウィンドウが表示されます．

一番右の「トラック」のチェックボックスを見ると，デフォルトですべて埋まっています．これは，録画ファイルのすべてのトラックにすべての音声ソースが保存される設定になっていることを意味します．  
これだと編集の時に困るので，一つのトラックに一つの入力だけが保存されるように設定します．

一旦すべてのチェックを外し，以下のように設定します．

<div align="center"><img src="./imgs/28.png"></div>

これで，録画ファイルのトラック 1 にはデスクトップ音声のみ，トラック 2 にはデスクトップ音声 2 のみ，というように音声入力ごとに分かれて保存されるようになります．  
「音声ミキサー」に表示されているデバイスの名前を変えておくと，操作する際に分かりやすくなります．各デバイス下部の `⋮` をクリックし，「名前を変更」をクリックすると変更できます．

<div align="center"><img src="./imgs/29.png"></div>

「ソース」に映像ソースを追加し，配信したい映像を取り込めば，配信の準備は完了です．

---

最後に，オススメの追加設定を紹介します．

1. 「設定」>「一般」>「出力」より，以下のチェックボックスにチェックを入れる

- 配信を開始するときに確認ダイアログを表示する
- 配信を停止するときに確認ダイアログを表示する
- 録画を停止するときに確認ダイアログを表示する
- 配信時に自動的に録画する
- 配信が停止しても録画を継続する

これにより，操作ミスを防止でき，かつ配信映像を自動的に保存できるようになります．

2. 「設定」>「出力」>「録画」より，「スペースなしのファイル名を生成する」にチェックを入れる

3. 映像エンコーダを配信用に使っているエンコーダと分ける

もし，複数の GPU が使える場合，，録画用に別のエンコーダを使用することができます．GPU の負荷を見つつ，必要に応じて設定してください．

4. 「設定」>「詳細設定」>「録画」より，「ファイル名書式設定」を「`OBSREC_%CCYY-%MM-%DD_%hh-%mm-%ss`」にする

これにより，録画ファイル名に録画開始日時が付与され，管理しやすくなります．また，OBS で録画したファイルであることも分かるようになります．

5. 「設定」>「詳細設定」>「録画」より，「自動的に mp4 に最多重化する」のチェックボックスにチェックを入れる

これにより，録画終了時に自動的に `mp4` 形式に変換されます．

---

これで，OBS Studio から YouTube へのライブ配信が可能になりました．OBS のメインウィンドウ右下にある「配信開始」ボタンをクリックすると，配信が始まります．テスト配信を行い，自分の設定に問題がないか確認しましょう．
